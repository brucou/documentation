

<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><title>User interfaces as reactive systems — Kingly.js</title>
  <meta charset="utf-8">
  <meta name="description" content="Kingly - The Modelling Library for Portable UIs">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <meta property="og:type" content="article">
  <meta property="og:title" content="User interfaces as reactive systems — Kingly.js">
  <meta property="og:description" content="Kingly - The Modelling Library for Portable UIs">
  <meta property="og:image" content="https://brucou.github.io/documentation//documentation/images/kingly_logo.png">
  <!-- Twitter -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="User interfaces as reactive systems — Kingly.js">
  <meta name="twitter:description" content="Kingly - The Modelling Library for Portable UIs">
  <meta name="twitter:image" content="https://brucou.github.io/documentation/images/kingly_logo.png">

  <link rel="apple-touch-icon" sizes="180x180" href="/documentation/images/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/documentation/images/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="256x256" href="/documentation/images/icons/favicon-256x256.png">
  <link rel="icon" href="/documentation/images/kingly_logo.png" type="image/png">

  <link href="//fonts.googleapis.com/css?family=Lato:300,400,600" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Overlock:400&text=Kingly.js" rel="stylesheet" type="text/css">

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

  <!-- main page styles -->
  <link rel="stylesheet" href="/documentation/css/page.css">

  <!--<script src="/documentation/js/kingly.js"></script>-->

  <!-- ga -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-141924019-1', 'brucou.github.io/documentation');
    ga('send', 'pageview');
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  </head>

  <body class="docs">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="mobile-bar">
      <a class="menu-button"></a>
      <a class="logo" href="/documentation"></a>
    </div>
    

<div id="header">
  <a id="logo" href="/documentation/">
    <img src="/documentation/images/kingly_logo.png" alt="library logo">
    <span>Kingly</span>
    
  </a>
  <ul id="nav">
    <li class="nav-dropdown-container learn">
  <a class="nav-link">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/concepts/" class="nav-link">Concepts</a></li>
        <li><a href="/documentation/v1/tutorials/" class="nav-link">Tutorials</a></li>
        <li><a href="/documentation/v1/examples/" class="nav-link">Examples</a></li>
        <li><a href="/documentation/v1/cookbook/" class="nav-link">Cookbook</a></li>
        <li><a href="/documentation/v1/best-practices/" class="nav-link">Best practices</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/api/index.html" class="nav-link team">API</a>
</li>
<li class="nav-dropdown-container tooling">
  <a class="nav-link">Tooling</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/tooling/tools_overview.html" class="nav-link">Overview</a></li>
        <li><a href="/documentation/v1/tooling/graph_editing.html" class="nav-link">Graph editing</a></li>
        <li><a href="/documentation/v1/tooling/compiling.html" class="nav-link">Compiling</a></li>
        <li><a href="/documentation/v1/tooling/devtool.html" class="nav-link">Devtool</a></li>
      </ul>
    </li>
  </ul>
</li>

<li class="nav-dropdown-container integrations">
  <a class="nav-link">Integrations</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/int-vanilla/" class="nav-link">Vanilla js</a></li>
        <li><a href="/documentation/v1/int-react/" class="nav-link">React</a></li>
        <li><a href="/documentation/v1/int-vue/" class="nav-link">Vue</a></li>
        <li><a href="/documentation/v1/int-svelte/" class="nav-link">Svelte</a></li>
        <li><a href="/documentation/v1/int-others/" class="nav-link">Others</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/testing/index.html" class="nav-link team">Testing</a>
</li>
<li>
  <a href="/documentation/v1/contributed/index.html" class="nav-link team">Contributed</a>
</li>

  </ul>
</div>

    
      <div id="main" class="fix-sidebar">
          
  <div class="sidebar">
  <div class="sidebar-inner">
    <ul class="main-menu">
      <li class="nav-dropdown-container learn">
  <a class="nav-link">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/concepts/" class="nav-link">Concepts</a></li>
        <li><a href="/documentation/v1/tutorials/" class="nav-link">Tutorials</a></li>
        <li><a href="/documentation/v1/examples/" class="nav-link">Examples</a></li>
        <li><a href="/documentation/v1/cookbook/" class="nav-link">Cookbook</a></li>
        <li><a href="/documentation/v1/best-practices/" class="nav-link">Best practices</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/api/index.html" class="nav-link team">API</a>
</li>
<li class="nav-dropdown-container tooling">
  <a class="nav-link">Tooling</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/tooling/tools_overview.html" class="nav-link">Overview</a></li>
        <li><a href="/documentation/v1/tooling/graph_editing.html" class="nav-link">Graph editing</a></li>
        <li><a href="/documentation/v1/tooling/compiling.html" class="nav-link">Compiling</a></li>
        <li><a href="/documentation/v1/tooling/devtool.html" class="nav-link">Devtool</a></li>
      </ul>
    </li>
  </ul>
</li>

<li class="nav-dropdown-container integrations">
  <a class="nav-link">Integrations</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/int-vanilla/" class="nav-link">Vanilla js</a></li>
        <li><a href="/documentation/v1/int-react/" class="nav-link">React</a></li>
        <li><a href="/documentation/v1/int-vue/" class="nav-link">Vue</a></li>
        <li><a href="/documentation/v1/int-svelte/" class="nav-link">Svelte</a></li>
        <li><a href="/documentation/v1/int-others/" class="nav-link">Others</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/testing/index.html" class="nav-link team">Testing</a>
</li>
<li>
  <a href="/documentation/v1/contributed/index.html" class="nav-link team">Contributed</a>
</li>

    </ul>
    <div class="list">
      
        <h2>
          
          Contributed
          
        </h2>
        <ul class="menu-root">
  
    
    
    
    <li>
      <a href="/documentation/v1/contributed/writing_samples.html" class="sidebar-link">Writing samples</a>
    </li>
  
    
    
    
    <li>
      <a href="/documentation/v1/contributed/index.html" class="sidebar-link">Articles</a>
    </li>
  
    
    
    
    <li>
      <a href="/documentation/v1/contributed/visualizer.html" class="sidebar-link">Visualizer</a>
    </li>
  
</ul>

      
    </div>
  </div>
</div>



<div class="content contributed with-sidebar ">
  
    
    
  
  
    <h1>User interfaces as reactive systems</h1>
  
  
    <h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>As the name suggests, user interfaces allow a user to <strong>interface</strong> with other systems, with the idea that this interface will present some sought-for advantages vs. direct interaction with the mentioned systems.<br>For instance, when the interaction between systems becomes too complex (too many commands or sequences of commands, too many parameters, outputs difficult to exploit in their raw form, etc.), a user interface can help to reduce the cognitive load and the risk of errors on the user side. As a trivial example, while it is possible for a travel agent to interact directly with the reservation system, doing so through a well-designed user interface allows to have agents with little knowledge of the intricacies of the underlying systems. They can focus instead on mastery of their specific <strong>domain</strong> (travel<br>packages, customer segments, etc.) and the <strong>user stories</strong> which the user interface facilitates<br>(book a flight, cancel a hotel, etc.).</p>
<p>The user expresses an intent through some input means (key presses, vocal entry, etc.) with a view to realize pre-defined actions on the interfaced systems. Hence <strong>user interfaces are reactive systems</strong> almost by nature.</p>
<p>They are additionally <strong>concurrent systems</strong>, as the user can continue to send orders through the<br>user interface without waiting for the currently processed order to be completed. As such, user interface programming has the added complication of handling concurrency, both at a system and user interface level.</p>
<p>Any specification and implementation techniques for user interfaces must then specify a <strong>correspondence between user inputs and system actions</strong>, and the concurrent behaviour of the system. We will review thereafter specification and implementation techniques.</p>
<h1 id="Specification-and-implementation-techniques"><a href="#Specification-and-implementation-techniques" class="headerlink" title="Specification and implementation techniques"></a>Specification and implementation techniques</h1><p>In all what follows, it will be implicit that <code>event</code> and <code>action</code> are representations of the corresponding entities, i.e. not the actual events or actions, whatever that be, but symbols for those.</p>
<p>Functional and technical specifications for reactive systems must allow to extract :</p>
<ol>
<li>an interface by which the reactive system receives its events</li>
<li>a relation between events and actions such that $event \sim action$, where<ul>
<li>$\sim$ is called here the reactive relation</li>
<li>event is an event received through the user interface and triggering an action. Events can be<ul>
<li>user-initiated</li>
<li>system-initiated i.e. generated by the environment or external world</li>
</ul>
</li>
</ul>
</li>
<li>an interface with the systems through which actions intended by the user must be performed</li>
</ol>
<p>Because most reactive systems are stateful, the relation $\sim$ is not in general a <strong>deterministic</strong> (the same output associated for the same input, as opposed to probabilistic functions) <strong>function</strong> (which can only associate <strong>ONE</strong> output to an input).</p>
<p>Many frameworks for implementing user interfaces (<code>Angular2</code>, <code>Ember</code>,<br><code>Ractive</code>, <code>React</code>, etc.) make use of callback <strong>procedures</strong><sup><a href="#fn_defProcedure" id="reffn_defProcedure">defProcedure</a></sup>, or event handlers, which, when triggered by an event, directly <strong>perform</strong> the corresponding action. A few important issues stem from that choice : </p>
<ul>
<li>having the procedure directly handling in the same bundle different concerns such as input validation, performing triggered actions, error management, updating local state, makes it harder to trace, debug and reason about the program execution. The concurrent nature of user interfaces magnifies this issue. </li>
<li>procedures also do not compose as easily as pure functions, which limits the use of componentization techniques to reduce complexity and increase reuse. As a matter of fact, <code>React</code>‘s componentization model is limited to<br>addressing the view concern.</li>
<li>while generally optimized, efficient, and thorough, the low-level description such frameworks<br>offer is very far from the specification of the systems, making implementation error-prone and certification activities very difficult.</li>
</ul>
<p>However, when the reactive relation can be made into a deterministic function, by separating events and actions from their representation, and making local state explicit, miscellaneous implementation methods borrowing at various degrees from functional programming techniques, have some nice characteristics. We will focus in what follows on such implementation techniques.</p>
<p>To that purpose, we identify three models, which will be detailed thereafter :</p>
<ul>
<li>a reactive function gives for each event both the local state update, and the action to perform (<code>Elm</code> model)</li>
<li>a reactive function expressed as the transition function for an automata (state machine model)</li>
<li>a reactive function specified as a set of concurrent equations (the formal model)</li>
</ul>
<p>In any case, a reactive system run leads to traces which are the sequence of <code>(events, actions)</code><br>which have occurred during the period of the run. To a correct behaviour of a reactive system<br>corresponds a set of admissible traces. Conversely, testing a reactive system consists in<br>invalidating actual traces vs. the set of admissible traces. We will finish with addressing the<br>visualization of such traces.</p>
<blockquote id="fn_defProcedure">
<sup>defProcedure</sup>. In the present context, a procedure is a routine, i.e. a sequence of statements, written against a runtime system, which executes them. Such procedures may or may not take arguments, may or may not return values, and may or may not perform side-effects.<a href="#reffn_defProcedure" title="Jump back to footnote [defProcedure] in the text."> &#8617;</a>
</blockquote>
<h2 id="Reactive-system-as-a-joint-specification-of-local-state-updates-and-actions"><a href="#Reactive-system-as-a-joint-specification-of-local-state-updates-and-actions" class="headerlink" title="Reactive system as a joint specification of local state updates and actions"></a>Reactive system as a joint specification of local state updates and actions</h2><p>Most of the time, it is possible to formalize a state for the reactive system such that : $(action, new\ state) = f(state, event)$ where :</p>
<ul>
<li>$f$ is a pure function</li>
<li>$state$ subsumes all the variability resulting from the environment and the reactive system’s specifications, so that $f$ is pure</li>
</ul>
<p>$f$ will be termed here as the <strong>reactive function</strong>. If we index time chronologically by a natural integer, so that the index $n$ corresponds to the $n^{th}$ event occurring, we have :</p>
<ul>
<li>$(action_n,\ state_{n+1}) = f(state_n,\ event_n) $ where :<ul>
<li>$n$ is the $n^{th}$ event processed by the reactive system</li>
<li>$state_n$ is the state of the reactive system <strong>when the $n$th event is processed</strong></li>
<li>we hence have an implicit temporal relation here between the event occurrence and the state used to compute the reaction of the system.</li>
</ul>
</li>
</ul>
<p>Those observations give rise to implementation techniques relying on a reactive function $f$ which <strong>explicitly</strong> computes and exposes for each event the new state of the reactive system, and the action to execute. Notable examples are :</p>
<ul>
<li><strong>Elm</strong> : The <code>update :: Msg -&gt; Model -&gt; (Model, Cmd Msg)</code> function corresponds closely to the reactive function $f$, <code>Msg</code> to <code>events</code>, <code>Model</code> to <code>states</code>, <code>Cmd Msg</code> to <code>actions</code>.</li>
<li><strong>Purescript/pux</strong> : <code>foldp :: ∀ fx. Event -&gt; State -&gt; EffModel State Event fx</code> function is the equivalent formulation within <a href="http://purescript-pux.org/docs/architecture/" target="_blank" rel="noopener">purescript/pux</a> framework</li>
</ul>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>Here is for example a run for the user story <code>User can book a trip</code>, for a reservation system :</p>
<div class="table-container">
<table>
<thead>
<tr>
<th><code>n</code></th>
<th>Event</th>
<th>State (update)</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0</code></td>
<td>Init</td>
<td>is_round_trip : false today_date = ‘13.12.2017’</td>
<td>Fetch recent searches, origin list, destination list</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>Display initial screen</td>
</tr>
<tr>
<td><code>1</code></td>
<td>Click on <code>Return ticket</code></td>
<td>is_round_trip : true</td>
<td>Update screen with <code>Return Departure</code> enabled</td>
</tr>
<tr>
<td><code>2</code></td>
<td>Click on <code>From</code> dropdown</td>
<td></td>
<td>Update screen to display <code>Stations</code> dropdown</td>
</tr>
<tr>
<td><code>3</code></td>
<td>Select <code>Vienna</code></td>
<td></td>
<td>Update screen to display chosen trip’s origin</td>
</tr>
<tr>
<td><code>4</code></td>
<td>Click on <code>To</code> input field</td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>5</code></td>
<td>Type <code>p</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>6</code></td>
<td>Type <code>r</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>7</code></td>
<td>Type <code>a</code></td>
<td></td>
<td>Update screen with display of filtered origin list</td>
</tr>
<tr>
<td><code>8</code></td>
<td>Select Prague</td>
<td></td>
<td>Update screen to display chosen trip’s destination</td>
</tr>
<tr>
<td><code>9</code></td>
<td>Click on <code>Return Departure</code> input field</td>
<td></td>
<td>Update screen with calendar initialized with <code>today_date</code></td>
</tr>
<tr>
<td><code>10</code></td>
<td>Select <code>14.12.2017</code> as departure date</td>
<td></td>
<td>Update screen with chosen departure date</td>
</tr>
<tr>
<td><code>11</code></td>
<td>Click on <code>Search</code> button</td>
<td></td>
<td>Search API call to reservation database</td>
</tr>
<tr>
<td><code>12</code></td>
<td>API call completed successfully</td>
<td></td>
<td>Update screen with search results</td>
</tr>
</tbody>
</table>
</div>
<h2 id="Reactive-systems-as-automata"><a href="#Reactive-systems-as-automata" class="headerlink" title="Reactive systems as automata"></a>Reactive systems as automata</h2><p>By using streams to represent sequences over time, and using the functor associated to streams, the equation is rewrote as $(actions, next(states,\ events)) = f(states,\ events)$ where :</p>
<ul>
<li>$f$ is a pure function, taking a stream of events to a stream of actions</li>
<li>$next$ is derived from the reactive system’s specification<ul>
<li>i.e. specifying how the state of the reactive system changes in response to an event</li>
</ul>
</li>
<li>$states$ is a sequence where each value is the corresponding state of the reactive system at the time when an event is triggered, and subject to the equation :<ul>
<li>$states_0$ is the initial state of the system<ul>
<li>$next(states,\ events)$ is such that :<ul>
<li>$states_n = next(states_{n-1},\ events_{n-1})$ (1)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The $states$ stream hence has a recursive definition. Lazily-evaluated languages will allow for expressing $states$ quite naturally as a fixed point for $x \rightarrow next(x, events)$, while imperative languages may directly use<br>equation (1). We will refer to the <code>next</code> function as the <strong>state transition function</strong>.</p>
<p>Assuming the state transition function has been determined, the reactive system behaviour is<br>then entirely described by the following equations, which are those corresponding to a class of automata called state transducer<sup><a href="#fn_transducer" id="reffn_transducer">transducer</a></sup> :</p>
<blockquote id="fn_transducer">
<sup>transducer</sup>. Finite-State Machines, <a href="http://www.cse.chalmers.se/~coquand/AUTOMATA/book.pdf" target="_blank" rel="noopener">http://www.cse.chalmers.se/~coquand/AUTOMATA/book.pdf</a>, cf. p.479<a href="#reffn_transducer" title="Jump back to footnote [transducer] in the text."> &#8617;</a>
</blockquote>
<script type="math/tex; mode=display">\begin{cases}
states &=& next(states, events) \\\\\
actions &=& f(states, events)
\end{cases}</script><p>State transducers are state machines, which have an internal state, and on receiving an input, may produce an output and update their internal state. This opens the path to implementing reactive systems with state machines. This further opens the door to a well-studied set of techniques used in that area : tracing, visualization, automatic code generation, model-based testing, formal reasoning.</p>
<p>Knowing that state transducers are translators between input symbols and output symbols, it seems logical that they can be used for specifying and implementing reactive systems. As a matter of fact, a reactive system translates the actions of the user on the user interface to actions on the interfaced system.</p>
<p>A major reference for specification and implementation techniques based on the state machine formalism can be found in <em>Constructing the User Interface With Statecharts</em> by Ian Horrocks<sup><a href="#fn_Horrocks" id="reffn_Horrocks">Horrocks</a></sup>. Alternatively, an introduction to the technique can be found in this <a href="https://medium.com/@asolove/pure-ui-control-ac8d1be97a8d" target="_blank" rel="noopener">medium article</a>.</p>
<blockquote id="fn_Harel">
<sup>Harel</sup>. Programming reactive systems with state charts, David Harel<a href="#reffn_Harel" title="Jump back to footnote [Harel] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_Horrocks">
<sup>Horrocks</sup>. <a href="https://www.amazon.com/Constructing-User-Interface-Statecharts-Horrocks/dp/0201342782" target="_blank" rel="noopener">Constructing the User Interface With State charts, Ian Horrocks</a> <a href="#reffn_Horrocks" title="Jump back to footnote [Horrocks] in the text."> &#8617;</a>
</blockquote>
<p>A typical application area for statecharts is rapid prototyping of embedded systems as they occur<br> in avionics and automobile industry. Among other things, their success comes from two facts :</p>
<ul>
<li>it is an easy to learn language for design specialists who have more often a degree in<br>electrical or electronic engineering than a solid background in computer science. Those engineers<br>have a considerably better intuition of the meaning of automata than of algebraic<br>specification techniques, for instance.<ul>
<li>statecharts are available as description technique in commercial products (StateMate, Rhapsody, Stateflow, Yakindu Statechart Tools, visualSTATE, and many more).</li>
</ul>
</li>
</ul>
<h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h3><p>Here is, extracted from Ian Horrocks’ seminal book, an example of state charts specification for<br>a CD player. We reproduce here the state chart which synthesizes visually the state transition<br>function. Another document (not reproduced here) would specify the actual actions, and the<br>finer-grained modification to the state machine’s state to perform on transitioning, entering or<br>exiting control states:</p>
<p><img src="http://i.imgur.com/ygsOVi9.jpg" alt="CD player statechart specification"></p>
<h2 id="Reactive-systems-as-a-system-of-equations"><a href="#Reactive-systems-as-a-system-of-equations" class="headerlink" title="Reactive systems as a system of equations"></a>Reactive systems as a system of equations</h2><p>Assuming a monoid operation $\cup$ which allows to decompose actions into a sum of pieces, we can<br>write $actions = \cup_A actions_a$. Assuming that the same goes for events, and states :</p>
<script type="math/tex; mode=display">\begin{aligned}
actions  & = \bigcup_A actions_a \\\\\
         & = \bigcup_A f_a(states, events) \\\\\
         & = \bigcup_A f_a(\bigcup\_{S_a} states_s, \bigcup\_{E_a} events_e)
\end{aligned}</script><p>In FRP, $states<em>s$ are variables called behaviours, while $events_e$ and $actions_a$ are<br>events. We then rewrite our equation into a series of equations $actions_a = f_a(\cup\</em>{S<em>a} states_s, \cup\</em>{E_a} events_e)$, which computes actions of a given slice $a$ from the events $E_a$ and behaviours $S_a$ relevant to that<br>slice. As a matter of fact, it is often the case that a given action does not depend on the whole<br> set of events and behaviours but only a subset of such.</p>
<p>For instance, considering a reservation system with $events = \{search\_click, api\_call\_response\}$, and<br>$states =\{origin, destination, dates, cart\}$:  </p>
<script type="math/tex; mode=display">\begin{cases}
api\\_call & = f(\\{origin, destination, dates\\}, search\\_click) \\\\\
retry & = g(null, api\\_call\\_response) \\\\\
show\\_payment\\_screen & = h(cart, api\\_call\\_response)
\end{cases}</script><p>$api\_call$ does not depend on $cart$, nor does it depend on $api\_call\_response$.</p>
<p>Dataflow languages, such as Lucid Synchrone, use such an equational approach both for specification and implementation of reactive systems<sup><a href="#fn_synchronous" id="reffn_synchronous">synchronous</a></sup>. The approach used by Lucid Synchrone and the like is particularly interesting for user interfaces in safety-critical domain (avionics, automotive, medicine, nuclear plants…) with stringent certification requirements. By keeping the implementation close to the specification, restricting the target implementation language and defining formal semantics for it, it is possible to guarantee liveliness and safety properties of the implemented system.</p>
<blockquote id="fn_synchronous">
<sup>synchronous</sup>. <a href="https://www.lri.fr/~sebag/Slides/Pouzet.pdf" target="_blank" rel="noopener">https://www.lri.fr/~sebag/Slides/Pouzet.pdf</a>, Functional Synchronous Programming of Reactive Systems ; <a href="https://www.di.ens.fr/~pouzet/bib/chap_lucid_synchrone_english_iste08.pdf" target="_blank" rel="noopener">https://www.di.ens.fr/~pouzet/bib/chap_lucid_synchrone_english_iste08.pdf</a>, Synchronous Functional Programming: The Lucid Synchrone Experiment<a href="#reffn_synchronous" title="Jump back to footnote [synchronous] in the text."> &#8617;</a>
</blockquote>
<h3 id="Example-2"><a href="#Example-2" class="headerlink" title="Example"></a>Example</h3><p>We reproduce here the coffee machine example taken from <a href="https://www.di.ens.fr/~pouzet/lucid-synchrone/lucid-synchrone-3.0-manual.pdf" target="_blank" rel="noopener">lucid synchrone manual</a>. The description is the following. The machine may serve coffee or tea. A tea costs ten cents whereas a coffee costs five. The user may enter dimes or nickels. He can select a tea, a coffee or ask for his money back.</p>
<p>We see thereafter how the streams <code>drink</code> and <code>devolution</code> are equationally derived from streams<br><code>coin</code> and <code>button</code>, which are themselves derived from external systems (here the keyboard)<br><sup><a href="#fn_lucid" id="reffn_lucid">lucid</a></sup>. </p>
<blockquote id="fn_lucid">
<sup>lucid</sup>. Note the use of recursivity to equationally define the operator <code>coffee</code> : use of <code>rec</code> and <code>last</code>. Also, the keyword <code>node</code> is used to indicate <em>combinatorial</em> streams (vs. sequential streams), which are streams whose current value depends on past values. <a href="#reffn_lucid" title="Jump back to footnote [lucid] in the text."> &#8617;</a>
</blockquote>
<pre><code class="hljs undefined">type coin = Dime | Nickel
type drinks = Coffee | Tea
type buttons = BCoffee | BTea | BCancel

(* producing events from the keyboard *)
let node input key = (coin, button) where
match key with
    &quot;N&quot; -&gt; do emit coin = Nickel done
  | &quot;D&quot; -&gt; do emit coin = Dime done
  | &quot;C&quot; -&gt; do emit button = BCoffee done
  | &quot;T&quot; -&gt; do emit button = BTea done
  | &quot;A&quot; -&gt; do emit button = BCancel done
  | _ -&gt; do done
  end

(* Now we define a function which outputs a drink and returns some money when necessary. *)
let node coffee coin button = (drink, devolution) where
  rec last v = 0
  and present
      coin(Nickel) -&gt;
        do v = last v + 5 done
      | coin(Dime) -&gt;
        do v = last v + 10 done
      | button(BCoffee) -&gt;
        do (drink, v) = vend Coffee 10 (last v)
        done
      | button(BTea) -&gt;
        do (drink, v) = vend Tea 5 (last v)
        done
      | button(BCancel) -&gt;
        do v = 0
        and emit devolution = last v
        done
  end

(* auxiliary : emits a drink if the accumulated value [v] is greater than [cost] *)
let node vend drink cost v = (o1, o2) where
    match v &gt;= cost with
      true -&gt;
        do emit o1 = drink
        and o2 = v - cost
        done
    | false -&gt;
        do o2 = v done
    end</code></pre>
<h3 id="An-imperative-language-approach"><a href="#An-imperative-language-approach" class="headerlink" title="An imperative language approach"></a>An imperative language approach</h3><p>A similar, though more relaxed approach, is taken by <code>cyclejs</code> which further collapses the $states$ stream into the $actions$ streams, by considering that state change is itself an action over the internal state of the system. To keep the equivalence to the original formulation, this approach however requires to clearly and consistently define the timing of the internal state update action vs. actions on the interfaced external systems : the internal state update must be executed before the next event is processed<sup><a href="#fn_instantStateUpdate" id="reffn_instantStateUpdate">instantStateUpdate</a></sup>. In the cycle framework, <code>App :: Sources -&gt; Sinks</code>, where <code>Sources</code> contains any necessary accessor/factory methods for the state of the system and events admitted by the system, and <code>Sinks</code> holds the actions triggered by the events.</p>
<p>Here is an example of cyclejs code, showing the split of the actions into two action streams,<br>each computed from its corresponding events and behaviours :</p>
<pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NavigationItem</span>(<span class="hljs-params">sources, settings</span>) </span>&#123;
  <span class="hljs-keyword">const</span> &#123; url$ &#125; = sources;
  <span class="hljs-keyword">const</span> &#123; <span class="hljs-attr">project</span>: &#123; title, link &#125; &#125; = settings;
  <span class="hljs-keyword">const</span> linkSanitized = link.replace(<span class="hljs-regexp">/\//i</span>, <span class="hljs-string">'_'</span>);

  <span class="hljs-keyword">const</span> events = &#123;
    <span class="hljs-comment">// NOTE : we avoid having to isolate by using the link which MUST be unique over the whole</span>
    <span class="hljs-comment">// application (unicity of a route)</span>
    click : sources.DOM.select(<span class="hljs-string">`.navigation-section__link.<span class="hljs-subst">$&#123;linkSanitized&#125;</span>`</span>).events(<span class="hljs-string">'click'</span>)
  &#125;;
  <span class="hljs-keyword">const</span> state$ = url$
    .map(<span class="hljs-function"><span class="hljs-params">url</span> =&gt;</span> url.indexOf(link) &gt; <span class="hljs-number">-1</span>)
    .shareReplay(<span class="hljs-number">1</span>);

  <span class="hljs-keyword">const</span> actions = &#123;
    <span class="hljs-attr">domUpdate</span> : state$.map(<span class="hljs-function"><span class="hljs-params">isLinkActive</span> =&gt;</span> &#123;
      <span class="hljs-keyword">const</span> isLinkActiveClass = isLinkActive ? <span class="hljs-string">'.navigation-section__link--active'</span> : <span class="hljs-string">''</span>;

      <span class="hljs-keyword">return</span> a(
        <span class="hljs-string">`<span class="hljs-subst">$&#123;isLinkActiveClass&#125;</span>.navigation-item.navigation-section__link.<span class="hljs-subst">$&#123;linkSanitized&#125;</span>`</span>,
        &#123; <span class="hljs-attr">attrs</span>: &#123; <span class="hljs-attr">href</span>: link &#125;, <span class="hljs-attr">slot</span>: <span class="hljs-string">'navigation-item'</span> &#125;,
        title)
    &#125;),
    <span class="hljs-attr">router</span> : events.click
      .do(preventDefault)
      .map(always(<span class="hljs-string">'/'</span> + link + <span class="hljs-string">'/'</span>))
  &#125;

  <span class="hljs-keyword">return</span> &#123;
    [DOM_SINK]: actions.domUpdate,
    <span class="hljs-attr">router</span>: actions.router
  &#125;
&#125;</code></pre>
<blockquote id="fn_cycle">
<sup>cycle</sup>. cycle however gives up on the purity of $f$ in exchange for a familiar interface for componentization - components are simply functions ; but keeps discriminating between action and action representation.<a href="#reffn_cycle" title="Jump back to footnote [cycle] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_instantStateUpdate">
<sup>instantStateUpdate</sup>. so that we maintain $states_n = next(states_{n-1}, events_{n-1})$. If the $n$th event would be processed before $state_n$ is set through the equation, the $next$ function could be computing an invalid state for the reactive system.<a href="#reffn_instantStateUpdate" title="Jump back to footnote [instantStateUpdate] in the text."> &#8617;</a>
</blockquote>
<h2 id="Visualization"><a href="#Visualization" class="headerlink" title="Visualization"></a>Visualization</h2><p>A run from the aforementioned <a href="#example">trip reservation interface example</a> may be represented<br>more succinctly on a timelined diagram :</p>
<pre><code class="hljs csv">events : iccsctttscscS
state  : ++-----------
actions: fuuu---uuuuSu
         u

c : click event
s : select event
t : type event
S : search API call event/action
u : update screen event
f : fetch remote data
+ : state update</code></pre>
<p>Implementations of reactive systems which allow to obtain the trace of a run as a sequence of <code>(event, action)</code> (or any equivalent format) also allow to reduce testing of such systems to checking<br> an actual trace vs. a set of expected traces.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>User interfaces are reactive systems and as such can be specified by means of its events/actions interface with the external systems of interest, and a pure reactive function mapping the actions of the user on the user interface to actions on the interfaced system.  </p>
<p>Implementation techniques leveraging functional programming techniques, can lead to an implementation closer to the specification, easier to reason about and maintain. In the best case, implementations may be automatically generated from the specifications and amenable to formal verification.</p>
<h1 id="Bibliography"><a href="#Bibliography" class="headerlink" title="Bibliography"></a>Bibliography</h1><ul>
<li><a href="https://www.di.ens.fr/~pouzet/bib/chap_lucid_synchrone_english_iste08.pdf" target="_blank" rel="noopener"><strong>Synchronous Functional Programming: The Lucid Synchrone Experiment</strong></a><br>Chapter 1.1 is an amazing introduction to the drivers behind the rise of synchronous languages vs. regular languages for critical software(avionics etc.) : the closeness between specification and implementation allows to formally guarantee properties.</li>
</ul>
<blockquote>
<p>Synchronous languages are based on the synchronous hypothesis. This hypothesis comes from the idea of separating the functional description of a system from the constraints of the architecture on which it will be executed.</p>
</blockquote>
<ul>
<li><a href="https://www.lri.fr/~sebag/Slides/Pouzet.pdf" target="_blank" rel="noopener"><strong>Functional Synchronous Programming of Reactive Systems</strong></a><br>Rationale behind functional synchronous programming for reactive systems, domains of application, state of the art.</li>
</ul>
<blockquote>
<p>Concurrency and determinism are absent but they are fundamental! Design specific languages with a limited expressive power, a formal semantics, well adapted to the culture of the field</p>
</blockquote>
<ul>
<li><a href="https://mitpress.mit.edu/books/concepts-techniques-and-models-computer-programming" target="_blank" rel="noopener"><strong>Concepts, Techniques, and Models of Computer Programming</strong></a><br>chapter 4, in particular section 4.3.4.</li>
<li><a href="https://www.tablesgenerator.com/markdown_tables" target="_blank" rel="noopener">markdown tables helper</a></li>
</ul>

  
  
  <div class="footer">
    Caught a mistake?
    <a href="https://github.com/brucou/kingly-site/tree/master/src/2017/06/11/User interfaces as reactive systems/" rel="noopener" target="_blank">
            Edit this on GitHub!
    </a>
    <a id="follow-button" class="btn" title="Kingly Github" href="https://github.com/brucou/kingly">
      <img class="github" src="/documentation/images/GitHub-Mark-32px.png" alt="github">
    </a>
  </div>
</div>

      </div>
      <script src="/documentation/js/smooth-scroll.min.js"></script>
    

    <!-- script for sidebars, version selects etc. -->
    <script src="/documentation/js/css.escape.js"></script>
    <script src="/documentation/js/common.js"></script>
    <!-- mathjax-->
    <script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
