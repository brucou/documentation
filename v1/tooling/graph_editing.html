

<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><title>Graph editors — Kingly.js</title>
  <meta charset="utf-8">
  <meta name="description" content="Kingly - The Modelling Library for Portable UIs">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Graph editors — Kingly.js">
  <meta property="og:description" content="Kingly - The Modelling Library for Portable UIs">
  <meta property="og:image" content="https://brucou.github.io/documentation//documentation/images/kingly_logo.png">
  <!-- Twitter -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Graph editors — Kingly.js">
  <meta name="twitter:description" content="Kingly - The Modelling Library for Portable UIs">
  <meta name="twitter:image" content="https://brucou.github.io/documentation/images/kingly_logo.png">

  <link rel="apple-touch-icon" sizes="180x180" href="/documentation/images/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/documentation/images/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="256x256" href="/documentation/images/icons/favicon-256x256.png">
  <link rel="icon" href="/documentation/images/kingly_logo.png" type="image/png">

  <link href="//fonts.googleapis.com/css?family=Lato:300,400,600" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Overlock:400&text=Kingly.js" rel="stylesheet" type="text/css">

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

  <!-- main page styles -->
  <link rel="stylesheet" href="/documentation/css/page.css">

  <!--<script src="/documentation/js/kingly.js"></script>-->

  <!-- ga -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-141924019-1', 'brucou.github.io/documentation');
    ga('send', 'pageview');
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  </head>

  <body class="docs">    <div id="mobile-bar">
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><a class="menu-button"></a>
      <a class="logo" href="/documentation"></a>
    </div>
    

<div id="header">
  <a id="logo" href="/documentation/">
    <img src="/documentation/images/kingly_logo.png" alt="library logo">
    <span>Kingly</span>
    
  </a>
  <ul id="nav">
    <li class="nav-dropdown-container learn">
  <a class="nav-link">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/tutorials/" class="nav-link">Tutorials</a></li>
        <li><a href="/documentation/v1/examples/" class="nav-link">Examples</a></li>
        <li><a href="/documentation/v1/cookbook/" class="nav-link">Cookbook</a></li>
        <li><a href="/documentation/v1/best-practices/" class="nav-link">Best practices</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/api/index.html" class="nav-link team">API</a>
</li>
<li class="nav-dropdown-container tooling">
  <a class="nav-link current">Tooling</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/tooling/graph_editing.html" class="nav-link current">Graph editing</a></li>
        <li><a href="/documentation/v1/tooling/compiling.html" class="nav-link">Compiling</a></li>
        <li><a href="/documentation/v1/tooling/devtool.html" class="nav-link">Devtool</a></li>
      </ul>
    </li>
  </ul>
</li>

<li class="nav-dropdown-container integrations">
  <a class="nav-link">Integrations</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/int-vanilla/" class="nav-link">Vanilla js</a></li>
        <li><a href="/documentation/v1/int-react/" class="nav-link">React</a></li>
        <li><a href="/documentation/v1/int-vue/" class="nav-link">Vue</a></li>
        <li><a href="/documentation/v1/int-svelte/" class="nav-link">Svelte</a></li>
        <li><a href="/documentation/v1/int-others/" class="nav-link">Others</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/testing/index.html" class="nav-link team">Testing</a>
</li>
<li>
  <a href="/documentation/v1/contributed/index.html" class="nav-link team">Contributed</a>
</li>

  </ul>
</div>

    
      <div id="main" class="fix-sidebar">
          
  <div class="sidebar">
  <div class="sidebar-inner">
    <ul class="main-menu">
      <li class="nav-dropdown-container learn">
  <a class="nav-link">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/tutorials/" class="nav-link">Tutorials</a></li>
        <li><a href="/documentation/v1/examples/" class="nav-link">Examples</a></li>
        <li><a href="/documentation/v1/cookbook/" class="nav-link">Cookbook</a></li>
        <li><a href="/documentation/v1/best-practices/" class="nav-link">Best practices</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/api/index.html" class="nav-link team">API</a>
</li>
<li class="nav-dropdown-container tooling">
  <a class="nav-link current">Tooling</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/tooling/graph_editing.html" class="nav-link current">Graph editing</a></li>
        <li><a href="/documentation/v1/tooling/compiling.html" class="nav-link">Compiling</a></li>
        <li><a href="/documentation/v1/tooling/devtool.html" class="nav-link">Devtool</a></li>
      </ul>
    </li>
  </ul>
</li>

<li class="nav-dropdown-container integrations">
  <a class="nav-link">Integrations</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/int-vanilla/" class="nav-link">Vanilla js</a></li>
        <li><a href="/documentation/v1/int-react/" class="nav-link">React</a></li>
        <li><a href="/documentation/v1/int-vue/" class="nav-link">Vue</a></li>
        <li><a href="/documentation/v1/int-svelte/" class="nav-link">Svelte</a></li>
        <li><a href="/documentation/v1/int-others/" class="nav-link">Others</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/testing/index.html" class="nav-link team">Testing</a>
</li>
<li>
  <a href="/documentation/v1/contributed/index.html" class="nav-link team">Contributed</a>
</li>

    </ul>
    <div class="list">
      
        <h2>
          
          
          
            <select class="version-select">
              <option value="SELF" selected>1.0</option>
            </select>
          
        </h2>
        <ul class="menu-root">
  
    
    
    
      
      
      
    
    <li>
      <a href="/documentation/v1/tooling/graph_editing.html" class="sidebar-link current new">Graph editors</a>
    </li>
  
    
    
    
      
      
      
    
    <li>
      <a href="/documentation/v1/tooling/compiling.html" class="sidebar-link new">Compiler</a>
    </li>
  
    
    
    
      
      
    
    <li>
      <a href="/documentation/v1/tooling/devtool.html" class="sidebar-link new">Dev tool</a>
    </li>
  
</ul>

      
    </div>
  </div>
</div>



<div class="content tooling with-sidebar ">
  
    
    
  
  
    <h1>Graph editors</h1>
  
  
    <h2 id="Graph-editing-with-yEd"><a href="#Graph-editing-with-yEd" class="headerlink" title="Graph editing with yEd"></a>Graph editing with yEd</h2><p><code>yEd</code> is a fairly intuitive graph editor. Instructions on how to use it can be found online. A short video (90s) introduction to <code>yEd</code> features is as follows:</p>
<div class="video-container"><iframe src="//www.youtube.com/embed/OmSTwKw7dX4" frameborder="0" allowfullscreen></iframe></div>
<p>A longer and more practical introduction addressing basic editing of graphs with <code>yEd</code>:</p>
<div class="video-container"><iframe src="//www.youtube.com/embed/ujMhxPJnJCw" frameborder="0" allowfullscreen></iframe></div>
<p>You will need to go to <code>yEd</code>‘s website and download the editor to use on your desktop. You can also use <code>yEd live</code> which is the online version of the editor. In that case, you need not download anything, and can edit a graph entirely from the browser. I do recommend the desktop version though for continuous use.</p>
<p>In a typical graph editing session, the machine designer will use two types of shapes: one for pseudo-control-states, another one for regular control states. In accordance with conventions, I commonly use a round, small shape for initial control states origin node, and history states. For atomic control states, I use a rectangular shape. I leave the shape for compound control states to be the default offered by <code>yEd</code>. </p>
<p>Shapes representing nodes can be linked with edges, which are entered by the user by clicking on the origin node of the edge, and dragging the mouse towards the destination node of the edge.  Edges can be edited by selecting them and pressing F2, or double-clicking on the edge. There are faster ways to do many node and edge handling which users will acquire once they get acquainted with the keyboard shortcuts. </p>
<p>To create a compound control state, also called a group, simply create a node, select that node, then right-click, then click <em>Grouping</em> (or <kbd>Ctrl-Alt-G</kbd>). Once you have such a group, you can double click on it to enter that group and see only the contents of that group. You can navigate back up with the right menu <em>Grouping -&gt; Previous view</em> or <kbd>Alt-Page-Up</kbd>. Groups can be collapsed or expanded (click on -/+ icon in the top-left corner of the compound node). </p>
<p>One of the things that make <code>yEd</code> great is that you do not need to think about layouting the graph. Just add the nodes in random places, and focus on having the graph relations right. You can then use a large set of computer-generated layouts. The ones I use most commonly are the hierarchic layout, the orthogonal layout, the flowchart, and the BPMN layout. After playing a bit with the layouts, you will pick the one that expressees visually the best the relationship. Hierarchic layouts are for instance often useful when writing machines for user interfaces, because such machines often have a preferred direction, with a few dropbacks: the user progresses on a user flow, with occasionally returning to a previous stage of the flow (error, correcting inputs, etc.). Orthogonal layouts often use better the space, but do not display visually well graphs with expanded compound nodes. It takes only a few trials to get a sense of the layouts and their utility.</p>
<p>All layouts can be customized with an extensive suite of parameters (minimum distance between nodes, etc.). Layout option windows can be floated or docked (my favorite option). Once docked, running a layout consists only of clicking a play button. You will then see your graph visually morph into the selected layout. </p>
<p>Most of the graphs on the current documentation site have been authored and laid out with <code>yEd</code>. An example graph is as follows:</p>
<p>  <img src="https://imgur.com/VjKaIkL.png" alt="example of yed graph with history pseudo-state and compound state"></p>
<p>In the previous example, compound control states, i.e. nodes which contain other nodes, are represented in gray color. Pseudo-control-states are represented in dark orange color, while atomic control states, i.e. nodes which do not contain any other nodes are represented in yellow. There is no convention enforced for colors, nor for shapes, so feel free to pick the one you liked the most from the <em>Shape node</em> palette on the right (cf. video). </p>
<p>In the next section, we will describe the <code>yed2kingly</code> utility script which supports converting a <code>yEd</code> graphml file containing nodes, edges, node labels and edge labels into a Kingly state machine.</p>
<h2 id="yed2kingly"><a href="#yed2kingly" class="headerlink" title="yed2kingly"></a>yed2kingly</h2><h3 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h3><p>The <code>yed2kingly</code> package aims at supporting the creation of state machines with the <a href="https://brucou.github.io/documentation/">Kingly state machine library</a>. While by design the Kingly configuration for state machines follows a simple and minimal syntax, crafting and maintaining a large state machine by hand can involve repetitive tasks. Such tasks include for instance looking up a transition and remove it, or checking that a new transition to add does not conflict with an existing one.</p>
<p> Furthermore, a large machine is rarely written directly in a textual format but is rather supported by some kind of visualization whether hand-written graphs or professional graph editors. When switching to text editing, the visual information is lost, the text-based version eventually becomes desynchronized with the visualization. </p>
<p>This is a case in hand where visual tooling can strengthen part of an error-prone manual process, and automate the repetitive tasks.</p>
<p><a href="https://www.yworks.com/products/yed" target="_blank" rel="noopener">yEd</a> is a versatile professional graph editor that produces high-quality diagrams for a large set of use cases. yEd is not open source, however, there is no fee linked to its usage as an end-user. I have been using it for the past four years to generate all kinds of diagrams including state machine graphs. The key features that I found extremely valuable in this time are the accessibility to non-professional users (this is no photoshop), its large set of sophisticated automatic highly-customizable layouts, and its text-based versionable graphml format.</p>
<p>This makes yEd a valuable tool to use for state machine creation, edition and maintenance. yEd exists in desktop and online versions. I recommend strongly the desktop version on the grounds that it is more productive for serious tasks, but your mileage may vary. For educational or demonstration purposes, there may be educational value in the online version.</p>
<h3 id="How-does-it-work"><a href="#How-does-it-work" class="headerlink" title="How does it work?"></a>How does it work?</h3><p>In a typical process, I start designing a machine from the specifications by drawing it in the yEd editor. When I am done or ready to test the results of my design, I save the file. yEd by default saves its files in a <code>.graphml</code> format. I save the graphml file in the same directory in which I want to use the created state machine. From there, a previously launched watcher runs the <code>yed2kingly</code> node script on the newly saved file and generates a JavaScript file that exports the events, state hierarchy and transitions contained in the graph — you can of course also run the script manually instead of using a watcher. The provided <code>exports</code> can then be used as parameters to create a Kingly state machine.</p>
<h3 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h3><p><code>npm install yed2kingly</code></p>
<h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><pre><code class="hljs bash">yed2kingly file.graphml</code></pre>
<p>Running the converter produces two files, targeted at consumption in a browser and node.js environment:</p>
<p>Before:<br><pre><code class="hljs bash">src/graphs/file.graphml</code></pre></p>
<p>After:<br><pre><code class="hljs bash">src/graphs/file.graphml.fsm.js
src/graphs/file.graphml.fsm.cjs</code></pre></p>
<p>The converter must emit an error or exit with an error code if the converted graph will not give rise to a valid Kingly machine (in particular cf. rules). The idea is to fail as early as possible.</p>
<p>The produced file export three objects: the events, state hierarchy and a transition factory. The first two objects can be used directly as parameters to create a Kingly machine, i.e. they follow the Kingly format. The transition factory requires the developer to associate a JavaScript function to any action and guard labels that is in the graph. The developer thus passed an object containing this information and is returned a Kingly transitions object. I provide an example which should clarify the expected syntax and usage.  </p>
<h3 id="Rules"><a href="#Rules" class="headerlink" title="Rules"></a>Rules</h3><p>Some definitions:</p>
<ul>
<li>An initial transition is that which originates from a node whose label is <code>init</code></li>
<li>A top-level initial transition is that initial transition which does not have any parent node</li>
<li>A history pseudo-state is a node whose label is H (shallow history) or H* (deep history)</li>
<li>A compound node is a node that is created in the yEd interface by using the group functionality (<em>Grouping &gt; Group</em> or <em>Ctrl-Alt-G</em> in version 3.19).</li>
</ul>
<ul>
<li>yed2kingly rules:<ul>
<li>With the exception of history and init pseudo-states, all nodes are converted to Kingly states</li>
<li>The Kingly name for a compound state will be the label displayed in the yEd editor for the matching group nodes in a non-collapsed state. This is important as yEd has another name for group nodes in the collapsed state.</li>
<li>The label for any edge in the graph maps to a Kingly transition record. The chosen syntax is <code>event [guard] / action</code>. Anyone of the event, guard and action can be empty. Hence <code>[]/</code> is a valid syntax though not recommended.</li>
<li>There cannot be an action in the (unique by construction) top-level initial transition. There may be guards.</li>
<li>Labels <strong>must not</strong> include the reserved character <code>ღ</code></li>
<li>you can use the exact same label for different nodes (I do so in some of the tests), however, beware that this may come and bite you when you are tracing or debugging</li>
<li>The action label cannot be the reserved label <code>ACTION_IDENTITY</code></li>
<li>A label <code>x</code> must be so that the following JavaScript <code>{[x]: value}</code> is valid syntactically. This means labels can have spaces and a large set of Unicode characters, as allowed by the JavaScript specifications. Action labels such as <em>do this, do that</em> are thus valid.</li>
<li>Edge labels <strong>must not</strong> have more than one <code>/</code> character (action separator)</li>
<li>Edge labels <strong>must not</strong> have any <code>|</code> character (transition separator)</li>
<li>an edge label may encode several transitions, separated by <code>|</code>. All rules above apply to each of the transition as if it was alone</li>
</ul>
</li>
</ul>
<p>In short:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Edge label</th>
<th>Valid</th>
</tr>
</thead>
<tbody>
<tr>
<td>start / display initial screen</td>
<td>Yes</td>
</tr>
<tr>
<td>start / display / initial screen</td>
<td>No</td>
</tr>
<tr>
<td>typed [letters?] / display password</td>
<td>Yes</td>
</tr>
<tr>
<td>typed [!letters?] /</td>
<td>Yes</td>
</tr>
<tr>
<td>typed [!letters?]</td>
<td>Yes</td>
</tr>
<tr>
<td>[!letters?]</td>
<td>Yes</td>
</tr>
<tr>
<td>[!letters?] / display password</td>
<td>Yes</td>
</tr>
<tr>
<td>start</td>
<td>Yes</td>
</tr>
<tr>
<td>[]</td>
<td>Yes</td>
</tr>
<tr>
<td>/</td>
<td>Yes</td>
</tr>
<tr>
<td>[] /</td>
<td>Yes</td>
</tr>
<tr>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>/ display password</td>
<td>Yes</td>
</tr>
<tr>
<td>成為   [或不]   / 成為</td>
<td>Yes</td>
</tr>
<tr>
<td>&#124; start / display initial screen &#124; reset / navigate back</td>
<td>Yes, parses two transitions</td>
</tr>
<tr>
<td>&#124; start [letters?&#124;] / display initial screen &#124; reset / navigate back</td>
<td>No</td>
</tr>
</tbody>
</table>
</div>
<p>We recommend to use the pipe character <code>|</code> exclusively and only to separate transitions.</p>
<h3 id="Conventions"><a href="#Conventions" class="headerlink" title="Conventions"></a>Conventions</h3><p>The following conventions are not rules and are not enforced in any way. They exist for practicality or readability purposes.</p>
<ul>
<li>Nodes for machine states have a rectangular shape</li>
<li>Init pseudo-states are represented by a small circle with a different color than regular nodes</li>
<li>Compound states (group nodes in yEd terminology) should also be displayed in a third color </li>
</ul>
<h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><p>There are plenty of graph examples in the <a href="https://github.com/brucou/yed2kingly/tree/master/tests/graphs" target="_blank" rel="noopener">test directory</a>. An example, extracted from the tests directory and involving compound states and history pseudo-states is as follows:</p>
<p><img src="https://imgur.com/VjKaIkL.png" alt="example of yed graph with history pseudo-state and compound state"></p>
<p>Running the <code>yed2kingly</code> script produces the following JavaScript file:</p>
<pre><code class="hljs js"><span class="hljs-comment">// Copy-paste help</span>
<span class="hljs-comment">// For debugging purposes, functions should all have a name</span>
<span class="hljs-comment">// Using natural language sentences in the graph is valid</span>
<span class="hljs-comment">// However, you will have to find a valid JavaScript name for the matching function</span>
<span class="hljs-comment">// -----Guards------</span>
<span class="hljs-comment">// const guards = &#123;</span>
<span class="hljs-comment">// &#125;;</span>
<span class="hljs-comment">// -----Actions------</span>
<span class="hljs-comment">// const actions = &#123;</span>
<span class="hljs-comment">//   "logGroup1toH": function ()&#123;&#125;,,,</span>
<span class="hljs-comment">//   "logBtoC": function ()&#123;&#125;,,</span>
<span class="hljs-comment">//   "logBtoD": function ()&#123;&#125;,,</span>
<span class="hljs-comment">//   "logCtoD": function ()&#123;&#125;,,</span>
<span class="hljs-comment">//   "logGroup1toD": function ()&#123;&#125;,,</span>
<span class="hljs-comment">//   "logGroup1toC": function ()&#123;&#125;,,</span>
<span class="hljs-comment">//   "logDtoD": function ()&#123;&#125;,</span>
<span class="hljs-comment">// &#125;;</span>
<span class="hljs-comment">// ----------------</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">contains</span>(<span class="hljs-params">as, bs</span>) </span>&#123;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">as</span>.every(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>&#123;
    <span class="hljs-keyword">return</span> bs.indexOf(a) &gt; <span class="hljs-number">-1</span>;
  &#125;);
&#125;
<span class="hljs-keyword">var</span> NO_OUTPUT = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">var</span> NO_STATE_UPDATE = [];
<span class="hljs-keyword">var</span> events = [<span class="hljs-string">"event3"</span>, <span class="hljs-string">"event2"</span>, <span class="hljs-string">"event1"</span>];
<span class="hljs-keyword">var</span> states = &#123;
  n1ღE: <span class="hljs-string">""</span>,
  <span class="hljs-string">"n2ღGroup 1"</span>: &#123; <span class="hljs-string">"n2::n0ღB"</span>: <span class="hljs-string">""</span>, <span class="hljs-string">"n2::n1ღC"</span>: <span class="hljs-string">""</span>, <span class="hljs-string">"n2::n2ღGroup 1"</span>: &#123; <span class="hljs-string">"n2::n2::n0ღD"</span>: <span class="hljs-string">""</span>, <span class="hljs-string">"n2::n2::n2ღD"</span>: <span class="hljs-string">""</span> &#125; &#125;,
&#125;;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getKinglyTransitions</span>(<span class="hljs-params">record</span>) </span>&#123;
  <span class="hljs-keyword">var</span> aF = record.actionFactories;
  <span class="hljs-keyword">var</span> guards = record.guards;
  <span class="hljs-keyword">var</span> actionList = [
    <span class="hljs-string">"logGroup1toH"</span>,
    <span class="hljs-string">"ACTION_IDENTITY"</span>,
    <span class="hljs-string">"logBtoC"</span>,
    <span class="hljs-string">"logBtoD"</span>,
    <span class="hljs-string">"logCtoD"</span>,
    <span class="hljs-string">"logGroup1toD"</span>,
    <span class="hljs-string">"logGroup1toC"</span>,
    <span class="hljs-string">"logDtoD"</span>,
  ];
  <span class="hljs-keyword">var</span> predicateList = [];
  aF[<span class="hljs-string">"ACTION_IDENTITY"</span>] = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ACTION_IDENTITY</span>(<span class="hljs-params"></span>) </span>&#123;
    <span class="hljs-keyword">return</span> &#123;
      <span class="hljs-attr">outputs</span>: NO_OUTPUT,
      <span class="hljs-attr">updates</span>: NO_STATE_UPDATE,
    &#125;;
  &#125;;
  <span class="hljs-keyword">if</span> (!contains(actionList, <span class="hljs-built_in">Object</span>.keys(aF))) &#123;
    <span class="hljs-built_in">console</span>.error(&#123; <span class="hljs-attr">actionFactories</span>: <span class="hljs-built_in">Object</span>.keys(aF), actionList &#125;);
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Some action are missing either in the graph, or in the action implementation object!"</span>);
  &#125;
  <span class="hljs-keyword">if</span> (!contains(predicateList, <span class="hljs-built_in">Object</span>.keys(guards))) &#123;
    <span class="hljs-built_in">console</span>.error(&#123; <span class="hljs-attr">guards</span>: <span class="hljs-built_in">Object</span>.keys(guards), predicateList &#125;);
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Some guards are missing either in the graph, or in the guard implementation object!"</span>);
  &#125;
  <span class="hljs-keyword">const</span> transitions = [
    &#123; <span class="hljs-attr">from</span>: <span class="hljs-string">"n2ღGroup 1"</span>, <span class="hljs-attr">event</span>: <span class="hljs-string">"event3"</span>, <span class="hljs-attr">to</span>: <span class="hljs-string">"n1ღE"</span>, <span class="hljs-attr">action</span>: aF[<span class="hljs-string">"logGroup1toH"</span>] &#125;,
    &#123; <span class="hljs-attr">from</span>: <span class="hljs-string">"n1ღE"</span>, <span class="hljs-attr">event</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">to</span>: &#123; <span class="hljs-attr">shallow</span>: <span class="hljs-string">"n2ღGroup 1"</span> &#125;, <span class="hljs-attr">action</span>: aF[<span class="hljs-string">"ACTION_IDENTITY"</span>] &#125;,
    &#123; <span class="hljs-attr">from</span>: <span class="hljs-string">"nok"</span>, <span class="hljs-attr">event</span>: <span class="hljs-string">"init"</span>, <span class="hljs-attr">to</span>: <span class="hljs-string">"n2::n0ღB"</span>, <span class="hljs-attr">action</span>: aF[<span class="hljs-string">"ACTION_IDENTITY"</span>] &#125;,
    &#123; <span class="hljs-attr">from</span>: <span class="hljs-string">"n2::n0ღB"</span>, <span class="hljs-attr">event</span>: <span class="hljs-string">"event2"</span>, <span class="hljs-attr">to</span>: <span class="hljs-string">"n2::n1ღC"</span>, <span class="hljs-attr">action</span>: aF[<span class="hljs-string">"logBtoC"</span>] &#125;,
    &#123; <span class="hljs-attr">from</span>: <span class="hljs-string">"n2::n0ღB"</span>, <span class="hljs-attr">event</span>: <span class="hljs-string">"event1"</span>, <span class="hljs-attr">to</span>: <span class="hljs-string">"n2::n2::n2ღD"</span>, <span class="hljs-attr">action</span>: aF[<span class="hljs-string">"logBtoD"</span>] &#125;,
    &#123; <span class="hljs-attr">from</span>: <span class="hljs-string">"n2::n1ღC"</span>, <span class="hljs-attr">event</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">to</span>: <span class="hljs-string">"n2::n2::n0ღD"</span>, <span class="hljs-attr">action</span>: aF[<span class="hljs-string">"logCtoD"</span>] &#125;,
    &#123; <span class="hljs-attr">from</span>: <span class="hljs-string">"n2::n2ღGroup 1"</span>, <span class="hljs-attr">event</span>: <span class="hljs-string">"init"</span>, <span class="hljs-attr">to</span>: <span class="hljs-string">"n2::n2::n0ღD"</span>, <span class="hljs-attr">action</span>: aF[<span class="hljs-string">"logGroup1toD"</span>] &#125;,
    &#123; <span class="hljs-attr">from</span>: <span class="hljs-string">"n2ღGroup 1"</span>, <span class="hljs-attr">event</span>: <span class="hljs-string">"init"</span>, <span class="hljs-attr">to</span>: <span class="hljs-string">"n2::n1ღC"</span>, <span class="hljs-attr">action</span>: aF[<span class="hljs-string">"logGroup1toC"</span>] &#125;,
    &#123; <span class="hljs-attr">from</span>: <span class="hljs-string">"n2::n2::n2ღD"</span>, <span class="hljs-attr">event</span>: <span class="hljs-string">"event1"</span>, <span class="hljs-attr">to</span>: <span class="hljs-string">"n2::n2::n0ღD"</span>, <span class="hljs-attr">action</span>: aF[<span class="hljs-string">"logDtoD"</span>] &#125;,
  ];

  <span class="hljs-keyword">return</span> transitions;
&#125;

<span class="hljs-keyword">export</span> &#123; events, states, getKinglyTransitions &#125;;</code></pre>
<p>The exported events, states, getKinglyTransitions can then be used in a regular JavaScript file as follows:</p>
<pre><code class="lang-js">    import {createStateMachine} from &#39;kingly&#39;;
    import {events, states, getKinglyTransitions} from &#39;tests/graphs/hierarchy-history-H.graphml.fsm.js&#39;;
(...)

    const guards = {};
    const actionFactories = {
      logGroup1toC: (s, e, stg) =&gt; traceTransition(&#39;Group1 -&gt; C&#39;),
      logBtoC: (s, e, stg) =&gt; traceTransition(&#39;B -&gt; C&#39;),
      logBtoD: (s, e, stg) =&gt; traceTransition(&#39;B -&gt; D&#39;),
      logCtoD: (s, e, stg) =&gt; traceTransition(&#39;C -&gt; D&#39;),
      logDtoGroup1H: (s, e, stg) =&gt; traceTransition(&#39;D -&gt; Group1H&#39;),
    };
    const fsmDef = {
      // NOTE: updateState and initialExtendedState are provided by the user
      updateState,
      initialExtendedState,
      events,
      states,
      transitions: getKinglyTransitions({ actionFactories, guards }),
    };
    const fsm = createStateMachine(fsmDef, settings);
</code></pre>
<h3 id="Final-note"><a href="#Final-note" class="headerlink" title="Final note"></a>Final note</h3><p>This process was chosen after plenty of reflection of pondering over what was the best approach for this functionality. A Babel plugin or macro was a possibility but the level of complexity was much higher — both from a macro creator and a macro user perspective, and the predictable requirements in terms of maintenance were also appreciable. The retained solution is to produce the outputs of the file conversion in a separate, independent JavaScript file. There is thus no necessity to write proprietary JavaScript, it is programming as usual.</p>
<p>This is a first version based on personal usage. Comments and recommendations are welcome if you have them about a better way to handle the integration of a graph editor with Kingly JavaScript library. Feel free to open an issue.</p>

  
  
  <div class="footer">
    <a id="follow-button" class="btn" title="Kingly Github" href="https://github.com/brucou/kingly">
      <img class="github" src="/documentation/images/GitHub-Mark-32px.png" alt="github">
    </a>
    <a id="follow-button" class="btn" title="Follow Kingly on Twitter" href="https://twitter.com/intent/follow?original_referer=https%3A%2F%2Fbrucou.github.io/documentation%2F&amp;ref_src=twsrc%5Etfw&amp;region=follow_link&amp;screen_name=bricoi1&amp;tw_p=followbutton">
      <img class="twitter" src="/documentation/images/icons8-twitter-48.png" alt="twitter">
    </a>
  </div>
</div>

      </div>
      <script src="/documentation/js/smooth-scroll.min.js"></script>
    

    <!-- script for sidebars, version selects etc. -->
    <script src="/documentation/js/css.escape.js"></script>
    <script src="/documentation/js/common.js"></script>
    <!-- mathjax-->
    <script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</body>
</html>
