

<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><title>makeWebComponentFromFsm — Kingly.js</title>
  <meta charset="utf-8">
  <meta name="description" content="Kingly - The Modelling Library for Portable UIs">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <meta property="og:type" content="article">
  <meta property="og:title" content="makeWebComponentFromFsm — Kingly.js">
  <meta property="og:description" content="Kingly - The Modelling Library for Portable UIs">
  <meta property="og:image" content="https://brucou.github.io/documentation//documentation/images/kingly_logo.png">
  <!-- Twitter -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="makeWebComponentFromFsm — Kingly.js">
  <meta name="twitter:description" content="Kingly - The Modelling Library for Portable UIs">
  <meta name="twitter:image" content="https://brucou.github.io/documentation/images/kingly_logo.png">

  <link rel="apple-touch-icon" sizes="180x180" href="/documentation/images/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/documentation/images/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="256x256" href="/documentation/images/icons/favicon-256x256.png">
  <link rel="icon" href="/documentation/images/kingly_logo.png" type="image/png">

  <link href="//fonts.googleapis.com/css?family=Lato:300,400,600" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Overlock:400&text=Kingly.js" rel="stylesheet" type="text/css">

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

  <!-- main page styles -->
  <link rel="stylesheet" href="/documentation/css/page.css">

  <!--<script src="/documentation/js/kingly.js"></script>-->

  <!-- ga -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', '', 'brucou.github.io/documentation');
    ga('send', 'pageview');
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  </head>

  <body class="docs">    <div id="mobile-bar">
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><a class="menu-button"></a>
      <a class="logo" href="/documentation"></a>
    </div>
    

<div id="header">
  <a id="logo" href="/documentation/">
    <img src="/documentation/images/kingly_logo.png" alt="library logo">
    <span>Kingly</span>
    
  </a>
  <ul id="nav">
    <li class="nav-dropdown-container learn">
  <a class="nav-link current">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/tutorials/" class="nav-link">Tutorials</a></li>
        <li><a href="/documentation/v1/examples/" class="nav-link">Examples</a></li>
        <li><a href="/documentation/v1/cookbook/" class="nav-link">Cookbook</a></li>
        <li><a href="/documentation/v1/best-practices/" class="nav-link">Best practices</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/api/index.html" class="nav-link team">API</a>
</li>
<li class="nav-dropdown-container integrations">
  <a class="nav-link">Integrations</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/int-vanilla/" class="nav-link">Vanilla js</a></li>
        <li><a href="/documentation/v1/int-react/" class="nav-link">React</a></li>
        <li><a href="/documentation/v1/int-vue/" class="nav-link">Vue</a></li>
        <li><a href="/documentation/v1/int-svelte/" class="nav-link">Svelte</a></li>
        <li><a href="/documentation/v1/int-others/" class="nav-link">Others</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/testing/index.html" class="nav-link team">Testing</a>
</li>
<li>
  <a href="/documentation/v1/contributed/index.html" class="nav-link team">Contributed</a>
</li>

  </ul>
</div>

    
      <div id="main" class="fix-sidebar">
          
  <div class="sidebar">
  <div class="sidebar-inner">
    <ul class="main-menu">
      <li class="nav-dropdown-container learn">
  <a class="nav-link current">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/tutorials/" class="nav-link">Tutorials</a></li>
        <li><a href="/documentation/v1/examples/" class="nav-link">Examples</a></li>
        <li><a href="/documentation/v1/cookbook/" class="nav-link">Cookbook</a></li>
        <li><a href="/documentation/v1/best-practices/" class="nav-link">Best practices</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/api/index.html" class="nav-link team">API</a>
</li>
<li class="nav-dropdown-container integrations">
  <a class="nav-link">Integrations</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/int-vanilla/" class="nav-link">Vanilla js</a></li>
        <li><a href="/documentation/v1/int-react/" class="nav-link">React</a></li>
        <li><a href="/documentation/v1/int-vue/" class="nav-link">Vue</a></li>
        <li><a href="/documentation/v1/int-svelte/" class="nav-link">Svelte</a></li>
        <li><a href="/documentation/v1/int-others/" class="nav-link">Others</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/testing/index.html" class="nav-link team">Testing</a>
</li>
<li>
  <a href="/documentation/v1/contributed/index.html" class="nav-link team">Contributed</a>
</li>

    </ul>
    <div class="list">
      
        <h2>
          
          API
          
            <select class="version-select">
              <option value="SELF" selected>1.0</option>
            </select>
          
        </h2>
        <ul class="menu-root">
  
    
    
    <li>
      <a href="/documentation/v1/api/index.html" class="sidebar-link">Overview</a>
    </li>
  
    
    
    <li>
      <a href="/documentation/v1/api/createStateMachine.html" class="sidebar-link">createStateMachine</a>
    </li>
  
    
    
    <li>
      <a href="/documentation/v1/api/traceFSM.html" class="sidebar-link">traceFSM</a>
    </li>
  
    
    
    <li>
      <a href="/documentation/v1/api/makeWebComponent.html" class="sidebar-link current">makeWebComponentFromFsm</a>
    </li>
  
    
    
    <li>
      <a href="/documentation/v1/api/API extensions.html" class="sidebar-link">Possible API extensions</a>
    </li>
  
    
    
    <li>
      <a href="/documentation/v1/api/terminology.html" class="sidebar-link">Terminology</a>
    </li>
  
</ul>

      
    </div>
  </div>
</div>



<div class="content api with-sidebar ">
  
    
    
  
  
    <h1>makeWebComponentFromFsm</h1>
  
  
    <p><code>makeWebComponentFromFsm :: ComponentDef -&gt; FSM</code></p>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>This factory function creates a web component which takes no observed attributes or properties. The behaviour or logic of the component is parameterized by the machine passed as parameter. The communication capability of the component is parameterized by subjects generated from a subject factory passed as parameter. The command handling capability are provided by command handlers  and effect handlers passed as parameters. An initial event, terminal event (unused for now), and a moniker indicating absence of actions to perform can be passed as options. </p>
<p>The web component receives input through its input subject, passes to the encapsulated machine which computes outputs and the component subsequently process those outputs via the command handlers. The web component may or may not use the output subject to emit events. At the moment, we do not have any example or test covering this use case.</p>
<p>Component whose behaviour is defined by a machine can be seamlessly integrated into any framework by converting to web component. Note however that the portion of the web component specification used, custom elements v1, is only supported in modern browsers. In the web component scenario, communication betwween the web component and other framework’s component occurs through the input and output subject or DOM events. It is not possible to use any facility provided by the framework. </p>
<h2 id="Contract"><a href="#Contract" class="headerlink" title="Contract"></a>Contract</h2><ul>
<li>Type contracts</li>
<li>web component name must fulfill web component’s specifications i.e. include an hyphen in its name</li>
</ul>
<h2 id="Implementation-example"><a href="#Implementation-example" class="headerlink" title="Implementation example"></a>Implementation example</h2><p>We have implemented a <a href="https://github.com/brucou/movie-search-app-nerv" target="_blank" rel="noopener">movie search app</a> with <a href="https://github.com/NervJS/nerv" target="_blank" rel="noopener">Nerv</a>, a lightweight React clone which works with browsers down to IE8. The entry file can be found <a href="https://github.com/brucou/movie-search-app-nerv/blob/master/src/index.js" target="_blank" rel="noopener">here</a>.</p>
<pre><code class="hljs javascript"><span class="hljs-keyword">const</span> fsm = createStateMachine(movieSearchFsmDef, &#123;
  <span class="hljs-attr">updateState</span>: applyJSONpatch,
  <span class="hljs-attr">debug</span>: &#123; <span class="hljs-built_in">console</span> &#125;
&#125;);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">subjectFromEventEmitterFactory</span>(<span class="hljs-params"></span>) </span>&#123;
  <span class="hljs-keyword">const</span> eventEmitter = emitonoff();
  <span class="hljs-keyword">const</span> DUMMY_NAME_SPACE = <span class="hljs-string">"_"</span>;
  <span class="hljs-keyword">const</span> _ = DUMMY_NAME_SPACE;
  <span class="hljs-keyword">const</span> subscribers = [];

  <span class="hljs-keyword">return</span> &#123;
    <span class="hljs-attr">next</span>: <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> eventEmitter.emit(_, x),
    <span class="hljs-attr">complete</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> subscribers.forEach(<span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> eventEmitter.off(_, f)),
    <span class="hljs-attr">subscribe</span>: <span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> (subscribers.push(f), eventEmitter.on(_, f))
  &#125;;
&#125;

<span class="hljs-keyword">const</span> nervRenderCommandHandler = &#123;
  [COMMAND_RENDER]: <span class="hljs-function">(<span class="hljs-params">next, params, effectHandlers, el</span>) =&gt;</span> &#123;
    <span class="hljs-keyword">const</span> &#123; screen, query, results, title, details, cast &#125; = params;
    <span class="hljs-keyword">const</span> props = params;
    render(screens(next)[screen](props), el);
  &#125;
&#125;;
<span class="hljs-keyword">const</span> commandHandlersWithRender = <span class="hljs-built_in">Object</span>.assign(
  &#123;&#125;,
  commandHandlers,
  nervRenderCommandHandler
);

<span class="hljs-keyword">const</span> options = &#123; <span class="hljs-attr">initialEvent</span>: &#123; [events.USER_NAVIGATED_TO_APP]: <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> &#125; &#125;;

makeWebComponentFromFsm(&#123;
  <span class="hljs-attr">name</span>: <span class="hljs-string">"movie-search"</span>,
  <span class="hljs-attr">eventSubjectFactory</span>: subjectFromEventEmitterFactory,
  fsm,
  <span class="hljs-attr">commandHandlers</span>: commandHandlersWithRender,
  effectHandlers,
  options
&#125;);

render(h(<span class="hljs-string">"movie-search"</span>), <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"root"</span>));</code></pre>

  
  
  <div class="footer">
    <a id="follow-button" class="btn" title="Kingly Github" href="https://github.com/brucou/kingly">
      <img class="github" src="/documentation/images/GitHub-Mark-32px.png" alt="github">
    </a>
    <a id="follow-button" class="btn" title="Follow Kingly on Twitter" href="https://twitter.com/intent/follow?original_referer=https%3A%2F%2Fbrucou.github.io/documentation%2F&amp;ref_src=twsrc%5Etfw&amp;region=follow_link&amp;screen_name=bricoi1&amp;tw_p=followbutton">
      <img class="twitter" src="/documentation/images/icons8-twitter-48.png" alt="twitter">
    </a>
  </div>
</div>

      </div>
      <script src="/documentation/js/smooth-scroll.min.js"></script>
    

    <!-- script for sidebars, version selects etc. -->
    <script src="/documentation/js/css.escape.js"></script>
    <script src="/documentation/js/common.js"></script>
    <!-- mathjax-->
    <script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
