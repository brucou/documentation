

<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><title>First steps — Kingly.js</title>
  <meta charset="utf-8">
  <meta name="description" content="Kingly - The Modelling Library for Portable UIs">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <meta property="og:type" content="article">
  <meta property="og:title" content="First steps — Kingly.js">
  <meta property="og:description" content="Kingly - The Modelling Library for Portable UIs">
  <meta property="og:image" content="https://brucou.github.io/documentation//documentation/images/kingly_logo.png">
  <!-- Twitter -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="First steps — Kingly.js">
  <meta name="twitter:description" content="Kingly - The Modelling Library for Portable UIs">
  <meta name="twitter:image" content="https://brucou.github.io/documentation/images/kingly_logo.png">

  <link rel="apple-touch-icon" sizes="180x180" href="/documentation/images/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/documentation/images/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="256x256" href="/documentation/images/icons/favicon-256x256.png">
  <link rel="icon" href="/documentation/images/kingly_logo.png" type="image/png">

  <link href="//fonts.googleapis.com/css?family=Lato:300,400,600" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Overlock:400&text=Kingly.js" rel="stylesheet" type="text/css">

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

  <!-- main page styles -->
  <link rel="stylesheet" href="/documentation/css/page.css">

  <!--<script src="/documentation/js/kingly.js"></script>-->

  <!-- ga -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-141924019-1', 'brucou.github.io/documentation');
    ga('send', 'pageview');
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  </head>

  <body class="docs">    <div id="mobile-bar">
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><a class="menu-button"></a>
      <a class="logo" href="/documentation"></a>
    </div>
    

<div id="header">
  <a id="logo" href="/documentation/">
    <img src="/documentation/images/kingly_logo.png" alt="library logo">
    <span>Kingly</span>
    
  </a>
  <ul id="nav">
    <li class="nav-dropdown-container learn">
  <a class="nav-link">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/concepts/" class="nav-link">Concepts</a></li>
        <li><a href="/documentation/v1/tutorials/" class="nav-link current">Tutorials</a></li>
        <li><a href="/documentation/v1/examples/" class="nav-link">Examples</a></li>
        <li><a href="/documentation/v1/cookbook/" class="nav-link">Cookbook</a></li>
        <li><a href="/documentation/v1/best-practices/" class="nav-link">Best practices</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/api/index.html" class="nav-link team">API</a>
</li>
<li class="nav-dropdown-container tooling">
  <a class="nav-link">Tooling</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/tooling/tools_overview.html" class="nav-link">Overview</a></li>
        <li><a href="/documentation/v1/tooling/graph_editing.html" class="nav-link">Graph editing</a></li>
        <li><a href="/documentation/v1/tooling/compiling.html" class="nav-link">Compiling</a></li>
        <li><a href="/documentation/v1/tooling/devtool.html" class="nav-link">Devtool</a></li>
      </ul>
    </li>
  </ul>
</li>

<li class="nav-dropdown-container integrations">
  <a class="nav-link">Integrations</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/int-vanilla/" class="nav-link">Vanilla js</a></li>
        <li><a href="/documentation/v1/int-react/" class="nav-link">React</a></li>
        <li><a href="/documentation/v1/int-vue/" class="nav-link">Vue</a></li>
        <li><a href="/documentation/v1/int-svelte/" class="nav-link">Svelte</a></li>
        <li><a href="/documentation/v1/int-others/" class="nav-link">Others</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/testing/index.html" class="nav-link team">Testing</a>
</li>
<li>
  <a href="/documentation/v1/contributed/index.html" class="nav-link team">Blog</a>
</li>

  </ul>
</div>

    
      <div id="main" class="fix-sidebar">
          
  <div class="sidebar">
  <div class="sidebar-inner">
    <ul class="main-menu">
      <li class="nav-dropdown-container learn">
  <a class="nav-link">Learn</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/concepts/" class="nav-link">Concepts</a></li>
        <li><a href="/documentation/v1/tutorials/" class="nav-link current">Tutorials</a></li>
        <li><a href="/documentation/v1/examples/" class="nav-link">Examples</a></li>
        <li><a href="/documentation/v1/cookbook/" class="nav-link">Cookbook</a></li>
        <li><a href="/documentation/v1/best-practices/" class="nav-link">Best practices</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/api/index.html" class="nav-link team">API</a>
</li>
<li class="nav-dropdown-container tooling">
  <a class="nav-link">Tooling</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/tooling/tools_overview.html" class="nav-link">Overview</a></li>
        <li><a href="/documentation/v1/tooling/graph_editing.html" class="nav-link">Graph editing</a></li>
        <li><a href="/documentation/v1/tooling/compiling.html" class="nav-link">Compiling</a></li>
        <li><a href="/documentation/v1/tooling/devtool.html" class="nav-link">Devtool</a></li>
      </ul>
    </li>
  </ul>
</li>

<li class="nav-dropdown-container integrations">
  <a class="nav-link">Integrations</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li>
      <ul>
        <li><a href="/documentation/v1/int-vanilla/" class="nav-link">Vanilla js</a></li>
        <li><a href="/documentation/v1/int-react/" class="nav-link">React</a></li>
        <li><a href="/documentation/v1/int-vue/" class="nav-link">Vue</a></li>
        <li><a href="/documentation/v1/int-svelte/" class="nav-link">Svelte</a></li>
        <li><a href="/documentation/v1/int-others/" class="nav-link">Others</a></li>
      </ul>
    </li>
  </ul>
</li>

<li>
  <a href="/documentation/v1/testing/index.html" class="nav-link team">Testing</a>
</li>
<li>
  <a href="/documentation/v1/contributed/index.html" class="nav-link team">Blog</a>
</li>

    </ul>
    <div class="list">
      
        <h2>
          
          Tutorials
          
            <select class="version-select">
              <option value="SELF" selected>1.0</option>
            </select>
          
        </h2>
        <ul class="menu-root">
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/site-map.html" class="sidebar-link">Site map</a>
    </li>
  
    
    
      
        <li><h3>Introduction</h3></li>
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/index.html" class="sidebar-link">Why Kingly</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/installation.html" class="sidebar-link">Get started</a>
    </li>
  
    
    
      
      
        <li><h3>Counter</h3></li>
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/counter-application.html" class="sidebar-link current">First steps</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/password-meter-implementation.html" class="sidebar-link">Machine implementation</a>
    </li>
  
    
    
      
      
      
        <li><h3>Password meter</h3></li>
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/password-meter.html" class="sidebar-link">Modeling</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/password-meter-ui-implementation.html" class="sidebar-link">Interface implementation</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/password-meter-using-graph-editor.html" class="sidebar-link new">Implementation with the yEd graph editor</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/password-meter-compiling.html" class="sidebar-link new">Compiling the machine</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/password-meter-learnt.html" class="sidebar-link">What we learned</a>
    </li>
  
    
    
      
      
      
      
        <li><h3>Chess game</h3></li>
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/chess-game.html" class="sidebar-link">Two-player chess game</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/chess-game-evolved.html" class="sidebar-link">Chess game - adding features</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/chess-game-ultimate.html" class="sidebar-link">Chess game - more features</a>
    </li>
  
    
    
      
      
      
      
      
      
        <li><h3 class="new">RealWorld clone</h3></li>
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/real-world.html" class="sidebar-link">RealWorld app</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/real-world-home.html" class="sidebar-link">Home route</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/real-world-sign-up.html" class="sidebar-link">Sign-up route</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/real-world-sign-in.html" class="sidebar-link">Sign-in route</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/real-world-editor.html" class="sidebar-link">Editor route</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/real-world-settings.html" class="sidebar-link">Settings route</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/real-world-profile.html" class="sidebar-link">User profile route</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/real-world-article.html" class="sidebar-link">Article route</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/real-world-refactoring.html" class="sidebar-link">Refactoring</a>
    </li>
  
    
    
      
      
      
      
      
      
    
    
    <li>
      <a href="/documentation/v1/tutorials/real-world-lessons-learnt.html" class="sidebar-link">Lessons learned</a>
    </li>
  
</ul>

      
    </div>
  </div>
</div>



<div class="content tutorials with-sidebar ">
  
    
    
  
  
    <h1>First steps</h1>
  
  
    <p>This section uses a fairly simple behavior to illustrate key concepts that underlie Kingly usage: application behavior, state machine modeling, and visual language. We also show how the application behavior can be connected to the rest of the application concerns — e.g., displaying screens, fetching remote data.</p>
<p>Do not worry if there are new words whose meaning is not entirely clear from the get go. The remainder of the tutorials will explore the concepts more in details. What follows will give you a preliminary feel of the API. </p>
<h2 id="Counter-application-behavior"><a href="#Counter-application-behavior" class="headerlink" title="Counter application behavior"></a>Counter application behavior</h2><p>Let’s implement the simplest behavior we can think of: a counter. The behavior of an application is <strong>the mapping of the reactions of the application to the set of possible events</strong>. Here, there is only one event: the user click on the incrementing button. The behavior of the counter application is to display an incremented counter every time the user clicks the incrementing button. In summary:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Event</th>
<th>Reaction</th>
</tr>
</thead>
<tbody>
<tr>
<td>click on button</td>
<td>display screen with incremented counter</td>
</tr>
</tbody>
</table>
</div>
<h2 id="Counter-application-modeling"><a href="#Counter-application-modeling" class="headerlink" title="Counter application modeling"></a>Counter application modeling</h2><p>A Kingly state machine is a function that computes the reactions (commands) corresponding to the event (input) it is passed as parameter. In pseudocode:</p>
<pre><code class="hljs js"><span class="hljs-comment">// fsm is a Kingly state machine</span>
<span class="hljs-keyword">const</span> commands = fsm(event);</code></pre>
<p>A Kingly state machine has two encapsulated pieces of state that are updated as events are processed: the <em>control state</em> and the <em>extended state</em>. To each control state is associated a different way to compute the reaction to events. Any such computation has access to the extended state of the machine in addition to the event, and returns the reactions (commands) to the processed event, after updating the machine state. In pseudocode, it would look as follows:</p>
<pre><code class="hljs js"><span class="hljs-keyword">let</span> controlState = ...;
<span class="hljs-keyword">let</span> extendedState= ...;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fsm</span>(<span class="hljs-params">event</span>)</span>&#123;
  <span class="hljs-keyword">if</span> (controlState === CS1)&#123;
    <span class="hljs-comment">// Updates state in closure</span>
    <span class="hljs-keyword">return</span> someComputation(event)    
  &#125;
  <span class="hljs-keyword">if</span> (controlState === CS2)&#123;
    <span class="hljs-comment">// Updates state in closure</span>
    <span class="hljs-keyword">return</span> anotherComputation(event)    
  &#125;
&#125;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">someComputation</span>(<span class="hljs-params">event</span>)</span>&#123;...&#125;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">anotherComputation</span>(<span class="hljs-params">event</span>)</span>&#123;...&#125;</code></pre>
<p>The control state takes its name from the fact that it determines the control flow (branch) of the machine computations. A state machine thus simply breaks down one stateful computation into several stateful computations that only apply when the machine is in specific control states. The challenge of modeling an application behavior is to identify those control states that determine the reaction to events in ways that are both economical and insightful.</p>
<p>For our counter application, it is rather simple. We only have one event, and one reaction to compute, so a single control state is enough. The extended state of the machine can host the counter value. The counter application behavior can thus be represented with a state machine that:</p>
<ul>
<li>starts  in the <em>Counting</em> control state;</li>
<li>encapsulates the counter value in its extended state (initial value 0); and</li>
<li>on every click, updates its internal state(identical control state, increment extended state), and displays the new screen.</li>
</ul>
<p>State machines can be visually represented by a graph that links together its control states. The counter behavior may for instance be visualized as follows:</p>
<p><img src="../../graphs/trivial counter machine.png" alt="counter machine"></p>
<p>The previous graph illustrates the <code>event [guard] / actions</code> notation that is used by the graph editor and throughout all the tutorials (guards are optional; here there are no guards; the syntax in this case shortens to <code>event / actions</code>). </p>
<p>Alright. So we have our behavior, the machine that model that behavior, the graph that represents the machine. We still have to draw the application screen. A Kingly machine merely computes commands, it does not execute commands (i.e., it does not perform effects besides updating its own state). We thus have left to write the procedures that execute the computed commands to have the full counter application. Our implementation is as follows: </p>
<iframe src="https://codesandbox.io/embed/w6x42521n7?fontsize=12&hidenavigation=1" title="Counter app" style="width:1000px; height:700px; border:0; border-radius: 4px; overflow:hidden;" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe>

<label for="mn-demo-10" class="margin-toggle">⊕</label><input type="checkbox" id="mn-demo-10" class="margin-toggle"><span class="marginnote"><p>Logs are activated by passing a console object in <code>settings</code> (<code>{ debug: { console }}</code>). We recommend to activate logs in the early stages of your learning and as a debugging tool.</p>
</span>
<p>Note how in the previous code events are passed as inputs to the machine, leading to commands being computed and executed. In this simple case, we opted for direct DOM updates to render the counter application screen.</p>
<p>Now open the console in the playground and have a look at the logs. Click the button once, and have another look at the logs. Formatting aside, you should see messages that allow following the machine computation step by step:</p>
<label for="mn-demo-23" class="margin-toggle">⊕</label><input type="checkbox" id="mn-demo-23" class="margin-toggle"><span class="marginnote"><ul>
<li>The first event (<code>init</code>) is an internal event that is sent to put the machine in its initial state. That event is sent when the machine is created. </li>
<li>The second event (<code>clicked</code>) corresponds to your button click.</li>
<li><em>Action factories</em> are functions that compute <em>actions</em>. Actions are of two kinds: updates to the machine extended state, and commands output by the machine.</li>
<li><code>ACTION_IDENTITY</code> stands for an action factory that produces no actions, leaving the state of the machine intact, and producing no commands.</li>
</ul>
</span>
<pre><code class="hljs bash">send event ▶&#123;init: Object&#125;

found event handler!
WHEN EVENT init ▶&#123;count: 0&#125;
IN STATE -nok-
CASE: unguarded transition
THEN: we execute the action factory ACTION_IDENTITY
left state -nok-
AND TRANSITION TO STATE -counting-
ENTERING NEXT STATE: -counting-
with extended state: ▶&#123;count: 0&#125;

send event ▶&#123;clicked: undefined&#125;

found event handler!
WHEN EVENT clicked undefined
IN STATE -counting-
CASE: unguarded transition
THEN: we execute the action factory incCounterAndDisplay
left state -counting-
AND TRANSITION TO STATE -counting-
ENTERING NEXT STATE: -counting-
with extended state: ▶&#123;count: 1&#125;

OUTPUTS: ▶(1) [Object]
         ▶0: Object
            <span class="hljs-built_in">command</span>: <span class="hljs-string">"render"</span>
            params: 1</code></pre>
<label for="mn-demo-30" class="margin-toggle">⊕</label><input type="checkbox" id="mn-demo-30" class="margin-toggle"><span class="marginnote"><p>“Sometimes the elegant implementation is a function. Not a method. Not a class. Not a framework. Just a function.” – <em>John Carmack</em></p>
</span>
<p>The previous code illustrates a key feature of Kingly’s state machines. <strong>They are normal, plain, standard JavaScript functions!</strong> That means you can replace the <code>fsm</code> created by Kingly in the previous code by a function <code>controller</code> fulfilling the same specifications:</p>
<pre><code class="hljs js"><span class="hljs-keyword">let</span> count=<span class="hljs-number">0</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">controller</span>(<span class="hljs-params">event</span>)</span>&#123;
  <span class="hljs-keyword">const</span> eventName = <span class="hljs-built_in">Object</span>.keys(event)[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">if</span> (eventName === <span class="hljs-string">'clicked'</span>)&#123;
    count++;
    <span class="hljs-keyword">return</span> [&#123;<span class="hljs-attr">command</span>: <span class="hljs-string">"render"</span>, <span class="hljs-attr">params</span>: count&#125;]
  &#125;
  
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>
&#125;</code></pre>
<p>This is it! You don’t need a PhD to understand Kingly state machines. You write stateful functions like <code>controller</code> all the time when implementing event handlers. Writing such functions by adopting the discipline of the state machine formalism brings a lot of benefits that will be introduced in the remainder of the tutorials. </p>
<h2 id="What-we-learned"><a href="#What-we-learned" class="headerlink" title="What we learned"></a>What we learned</h2><p>This is the very short story about state machines used for modeling the behavior of user interfaces. The application behavior is the set of its reactions to events. A Kingly state machine works as a functional, stateful controller that transforms events into commands. The application is implemented by composition of three parts: instantiation of event listeners, computation of the reaction (commands) to events, and execution of the reactions. To execute the command that render a screen, you can use any UI library you fancy, or just plain JavaScript — as we did in this example.</p>
<p>States machines can be visually represented by a graph whose nodes are the machine’s control states. The  edges of that graph represent the change of control state of the machine as it receives events.</p>
<p>Let’s move to a more interesting example: <a href="./password-meter.html">a password meter</a>.</p>

  
  
    <div class="next-links">
      
      
        <span>← <a href="/documentation/v1/tutorials/installation.html">Get started</a></span>
      
      
      
        <span style="float: right;"><a href="/documentation/v1/tutorials/password-meter-implementation.html">Machine implementation</a> →</span>
      
    </div>
  
  <div class="footer">
    Caught a mistake?
    <a href="https://github.com/brucou/kingly-site/tree/master/src/v1/tutorials/counter-application.md" rel="noopener" target="_blank">
            Edit this on GitHub!
    </a><br>
    Can we help you?     <a href="https://github.com/brucou/kingly/discussions/new" rel="noopener" target="_blank">
      Let us know!
    </a>
  </div>
</div>

      </div>
      <script src="/documentation/js/smooth-scroll.min.js"></script>
    

    <!-- script for sidebars, version selects etc. -->
    <script src="/documentation/js/css.escape.js"></script>
    <script src="/documentation/js/common.js"></script>
    <!-- mathjax-->
    <script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</body>
</html>
